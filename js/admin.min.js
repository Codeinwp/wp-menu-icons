!function(a){a("#menu-icons-settings-tabs").on("click","a.mi-settings-nav-tab",function(b){var c=a(this).blur(),d=a("#"+c.data("type"));b.preventDefault(),b.stopPropagation(),c.parent().addClass("tabs").siblings().removeClass("tabs"),d.removeClass("tabs-panel-inactive").addClass("tabs-panel-active").show().siblings("div.tabs-panel").hide().addClass("tabs-panel-inactive").removeClass("tabs-panel-active")}).find("a.mi-settings-nav-tab").first().click(),a("#menu-icons-settings-save").on("click",function(b){var c=a(this).prop("disabled",!0),d=c.siblings("span.spinner");b.preventDefault(),b.stopPropagation(),d.css({display:"inline-block",visibility:"visible"}),a.ajax({type:"POST",url:menuIcons.ajaxUrls.update,data:a("#menu-icons-settings :input").serialize(),success:function(a){!0===a.success&&a.data.redirectUrl?window.location=a.data.redirectUrl:c.prop("disabled",!1)},always:function(){d.hide()}})})}(jQuery),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){wp.media.model.MenuIconsItemSettingField=a("./models/item-setting-field.js"),wp.media.model.MenuIconsItemSettings=a("./models/item-settings.js"),wp.media.model.MenuIconsItem=a("./models/item.js"),wp.media.view.MenuIconsItemSettingField=a("./views/item-setting-field.js"),wp.media.view.MenuIconsItemSettings=a("./views/item-settings.js"),wp.media.view.MenuIconsItemPreview=a("./views/item-preview.js"),wp.media.view.MenuIconsSidebar=a("./views/sidebar.js"),wp.media.view.MediaFrame.MenuIcons=a("./views/frame.js")},{"./models/item-setting-field.js":2,"./models/item-settings.js":3,"./models/item.js":4,"./views/frame.js":5,"./views/item-preview.js":6,"./views/item-setting-field.js":7,"./views/item-settings.js":8,"./views/sidebar.js":9}],2:[function(a,b,c){var d=Backbone.Model.extend({defaults:{id:"",label:"",value:"",type:"text"}});b.exports=d},{}],3:[function(a,b,c){var d=Backbone.Collection.extend({model:wp.media.model.MenuIconsItemSettingField});b.exports=d},{}],4:[function(a,b,c){var d=Backbone.Model.extend({initialize:function(){this.on("change",this.updateValues,this)},updateValues:function(){_.each(this.get("$inputs"),function(a,b){a.val(this.get(b))},this),this.get("$el").trigger("mi:update")}});b.exports=d},{}],5:[function(a,b,c){var d=wp.media.view.MediaFrame.IconPicker.extend({initialize:function(){this.menuItems=new Backbone.Collection([],{model:wp.media.model.MenuIconsItem}),wp.media.view.MediaFrame.IconPicker.prototype.initialize.apply(this,arguments),this.listenTo(this.target,"change",this.miUpdateItemProps),this.on("select",this.miClearTarget,this)},miUpdateItemProps:function(a){var b=this.menuItems.get(a.id);b.set(a.changed)},miClearTarget:function(){this.target.clear({silent:!0})}});b.exports=d},{}],6:[function(a,b,c){var d=wp.media.View.extend({tagName:"p",className:"mi-preview menu-item attachment-info",events:{"click a":"preventDefault"},initialize:function(){wp.media.View.prototype.initialize.apply(this,arguments),this.model.on("change",this.render,this)},render:function(){var a=this.controller,b=a.state(),c=b.get("selection").single(),d=this.model.toJSON(),e=_.extend(d,{type:b.id,icon:c.id,title:this.model.get("$title").val(),url:b.ipGetIconUrl(c,d.image_size)}),f="menu-icons-item-sidebar-preview-"+iconPicker.types[b.id].templateId+"-";return f+=e.hide_label?"hide_label":e.position,this.template=wp.media.template(f),this.$el.html(this.template(e)),this},preventDefault:function(a){a.preventDefault()}});b.exports=d},{}],7:[function(a,b,c){var d,e=jQuery;d=wp.media.View.extend({tagName:"label",className:"setting",events:{"change :input":"_update"},initialize:function(){wp.media.View.prototype.initialize.apply(this,arguments),this.template=wp.media.template("menu-icons-settings-field-"+this.model.get("type")),this.model.on("change",this.render,this)},prepare:function(){return this.model.toJSON()},_update:function(a){var b=e(a.currentTarget).val();this.model.set("value",b),this.options.item.set(this.model.id,b)}}),b.exports=d},{}],8:[function(a,b,c){var d=wp.media.view.PriorityList.extend({className:"mi-settings attachment-info",prepare:function(){_.each(this.collection.map(this.createField,this),function(a){this.set(a.model.id,a)},this)},createField:function(a){var b=new wp.media.view.MenuIconsItemSettingField({item:this.model,model:a,collection:this.collection});return b}});b.exports=d},{}],9:[function(a,b,c){var d=wp.media.view.IconPickerSidebar.extend({initialize:function(){var a=new wp.media.View({tagName:"h3",priority:-10}),b=new wp.media.View({tagName:"p",className:"_info",priority:1e3});wp.media.view.IconPickerSidebar.prototype.initialize.apply(this,arguments),a.$el.text(menuIcons.text.preview),this.set("title",a),b.$el.html(menuIcons.text.settingsInfo),this.set("info",b)},createSingle:function(){this.createPreview(),this.createSettings()},disposeSingle:function(){this.unset("preview"),this.unset("settings")},createPreview:function(){var a=this,b=a.controller,c=b.state();return c.dfd&&"pending"===c.dfd.state()?void c.dfd.done(function(){a.createPreview()}):void a.set("preview",new wp.media.view.MenuIconsItemPreview({controller:b,model:b.target,priority:80}))},createSettings:function(){var a=this.controller,b=a.state(),c=b.get("data").settingsFields,d=[];_.each(c,function(b){var c,e=menuIcons.settingsFields[b];e&&(c=_.defaults({value:a.target.get(b)||e["default"]},e),d.push(c))}),d.length&&this.set("settings",new wp.media.view.MenuIconsItemSettings({controller:this.controller,collection:new wp.media.model.MenuIconsItemSettings(d),model:a.target,type:this.options.type,priority:120}))}});b.exports=d},{}]},{},[1]),function(a){"use strict";var b;menuIcons.activeTypes&&!_.isEmpty(menuIcons.activeTypes)&&(b={templates:{},wrapClass:"div.menu-icons-wrap",frame:null,target:new wp.media.model.IconPickerTarget,typesFilter:function(b){return-1<a.inArray(b.id,menuIcons.activeTypes)},createFrame:function(){b.frame=new wp.media.view.MediaFrame.MenuIcons({target:b.target,ipTypes:_.filter(iconPicker.types,b.typesFilter),SidebarView:wp.media.view.MenuIconsSidebar})},pickIcon:function(a){b.frame.target.set(a,{silent:!0}),b.frame.open()},setUnset:function(c){var d=a(c.currentTarget),e=a(c.target);c.preventDefault(),e.hasClass("_select")||e.hasClass("_icon")?b.setIcon(d):e.hasClass("_remove")&&b.unsetIcon(d)},setIcon:function(c){var d=c.data("id"),e=b.frame,f=e.menuItems,g=f.get(d);return g?void b.pickIcon(g.toJSON()):(g={id:d,$el:c,$title:a("#edit-menu-item-title-"+d),$inputs:{}},c.find("div._settings input").each(function(){var b=a(this),c=b.attr("class").replace("_mi-",""),d=b.val();d||(_.has(menuIcons.menuSettings,c)?d=menuIcons.menuSettings[c]:_.has(menuIcons.settingsFields,c)&&(d=menuIcons.settingsFields[c]["default"])),g[c]=d,g.$inputs[c]=b}),f.add(g),void b.pickIcon(g))},unsetIcon:function(a){var c=a.data("id");a.find("div._settings input").val(""),a.trigger("mi:update"),b.frame.menuItems.remove(c)},updateField:function(c){var d,e=a(c.currentTarget),f=e.find("a._select"),g=e.find("a._remove"),h=e.find("input._mi-type").val(),i=e.find("input._mi-icon").val(),j=e.find("input._mi-url").val();return""===h||""===i||0>_.indexOf(menuIcons.activeTypes,h)?(f.text(menuIcons.text.select).attr("title",""),void g.addClass("hidden")):(d=b.templates[h]?b.templates[h]:b.templates[h]=wp.template("menu-icons-item-field-preview-"+iconPicker.types[h].templateId),g.removeClass("hidden"),f.attr("title",menuIcons.text.change),void f.html(d({type:h,icon:i,url:j})))},init:function(){b.createFrame(),a(document).on("click",b.wrapClass,b.setUnset).on("mi:update",b.wrapClass,b.updateField),a(b.wrapClass).trigger("mi:update")}},b.init())}(jQuery);